# Generated by: depyler corpus generator
# Source: hard_algo_prefix_sum.py
#
# Prefix sum applications.


def build_prefix_sum(arr: List[int]) -> List[int]:
    """Build prefix sum array where prefix[i] = sum(arr[0..i-1])."""
    n: int = len(arr)
    prefix: List[int] = [0] * (n + 1)
    i: int = 0
    while i < n:
        prefix[i + 1] = prefix[i] + arr[i]
        i = i + 1
    return prefix


def range_sum(prefix: List[int], left: int, right: int) -> int:
    """Sum of arr[left..right] using prefix sums (inclusive)."""
    return prefix[right + 1] - prefix[left]


def count_subarrays_with_sum(arr: List[int], target: int) -> int:
    """Count subarrays that sum to target using prefix sums."""
    n: int = len(arr)
    count: int = 0
    i: int = 0
    while i < n:
        running: int = 0
        j: int = i
        while j < n:
            running = running + arr[j]
            if running == target:
                count = count + 1
            j = j + 1
        i = i + 1
    return count


def equilibrium_index(arr: List[int]) -> int:
    """Find index where left sum equals right sum. Returns -1 if none."""
    n: int = len(arr)
    if n == 0:
        return -1
    total: int = 0
    i: int = 0
    while i < n:
        total = total + arr[i]
        i = i + 1
    left_sum: int = 0
    i = 0
    while i < n:
        right_sum: int = total - left_sum - arr[i]
        if left_sum == right_sum:
            return i
        left_sum = left_sum + arr[i]
        i = i + 1
    return -1


def max_average_subarray(arr: List[int], window: int) -> int:
    """Maximum sum of subarray of given window size (proxy for average)."""
    n: int = len(arr)
    if n < window:
        return 0
    current: int = 0
    i: int = 0
    while i < window:
        current = current + arr[i]
        i = i + 1
    best: int = current
    i = window
    while i < n:
        current = current + arr[i] - arr[i - window]
        if current > best:
            best = current
        i = i + 1
    return best


def running_sum(arr: List[int]) -> List[int]:
    """Return running sum array."""
    n: int = len(arr)
    if n == 0:
        return []
    result: List[int] = [arr[0]]
    i: int = 1
    while i < n:
        result.append(result[i - 1] + arr[i])
        i = i + 1
    return result


def test_module() -> int:
    """Test all prefix sum functions."""
    passed: int = 0

    prefix: List[int] = build_prefix_sum([1, 2, 3, 4, 5])
    r1: int = range_sum(prefix, 1, 3)
    if r1 == 9:
        passed = passed + 1

    r2: int = range_sum(prefix, 0, 4)
    if r2 == 15:
        passed = passed + 1

    r3: int = count_subarrays_with_sum([1, 1, 1], 2)
    if r3 == 2:
        passed = passed + 1

    r4: int = equilibrium_index([-7, 1, 5, 2, -4, 3, 0])
    if r4 == 3:
        passed = passed + 1

    r5: int = equilibrium_index([1, 2, 3])
    if r5 == -1:
        passed = passed + 1

    r6: int = max_average_subarray([1, 12, -5, -6, 50, 3], 4)
    if r6 == 51:
        passed = passed + 1

    r7: List[int] = running_sum([1, 2, 3, 4])
    if r7 == [1, 3, 6, 10]:
        passed = passed + 1

    return passed
