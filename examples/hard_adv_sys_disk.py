# Generated by: depyler corpus generator
# Source: hard_adv_sys_disk.py
#
# Disk scheduling algorithms: FCFS, SSTF, SCAN (elevator), C-SCAN.


def abs_val(x_val: int) -> int:
    """Absolute value."""
    if x_val < 0:
        return 0 - x_val
    return x_val


def disk_fcfs(requests: list[int], head_start: int) -> int:
    """FCFS disk scheduling. Returns total head movement."""
    total: int = 0
    head: int = head_start
    i: int = 0
    n: int = len(requests)
    while i < n:
        req: int = requests[i]
        total = total + abs_val(req - head)
        head = req
        i = i + 1
    return total


def disk_sstf(requests: list[int], head_start: int) -> int:
    """SSTF (Shortest Seek Time First) disk scheduling."""
    total: int = 0
    head: int = head_start
    served: list[int] = []
    i: int = 0
    n: int = len(requests)
    while i < n:
        served.append(0)
        i = i + 1
    step: int = 0
    while step < n:
        best_idx: int = -1
        best_dist: int = 999999999
        j: int = 0
        while j < n:
            sv: int = served[j]
            if sv == 0:
                req: int = requests[j]
                dist: int = abs_val(req - head)
                if dist < best_dist:
                    best_dist = dist
                    best_idx = j
            j = j + 1
        if best_idx >= 0:
            served[best_idx] = 1
            total = total + best_dist
            head = requests[best_idx]
        step = step + 1
    return total


def disk_scan(requests: list[int], head_start: int, disk_size: int) -> int:
    """SCAN (elevator) disk scheduling going up first."""
    sorted_reqs: list[int] = []
    i: int = 0
    n: int = len(requests)
    while i < n:
        rv: int = requests[i]
        sorted_reqs.append(rv)
        i = i + 1
    j: int = 0
    while j < n - 1:
        k: int = j + 1
        while k < n:
            vj: int = sorted_reqs[j]
            vk: int = sorted_reqs[k]
            if vj > vk:
                sorted_reqs[j] = vk
                sorted_reqs[k] = vj
            k = k + 1
        j = j + 1
    total: int = 0
    head: int = head_start
    idx: int = 0
    while idx < n:
        sv: int = sorted_reqs[idx]
        if sv >= head:
            break
        idx = idx + 1
    m: int = idx
    while m < n:
        req2: int = sorted_reqs[m]
        total = total + abs_val(req2 - head)
        head = req2
        m = m + 1
    p: int = idx - 1
    while p >= 0:
        req3: int = sorted_reqs[p]
        total = total + abs_val(req3 - head)
        head = req3
        p = p - 1
    return total


def seek_count(requests: list[int], head_start: int) -> int:
    """Count total number of seeks (= number of requests)."""
    return len(requests)


def average_seek(total_movement: int, num_requests: int) -> int:
    """Compute average seek distance."""
    if num_requests == 0:
        return 0
    return total_movement // num_requests


def test_module() -> int:
    """Test disk scheduling algorithms."""
    passed: int = 0

    reqs: list[int] = [98, 183, 37, 122, 14, 124, 65, 67]

    fcfs_mov: int = disk_fcfs(reqs, 53)
    if fcfs_mov > 0:
        passed = passed + 1

    sstf_mov: int = disk_sstf(reqs, 53)
    if sstf_mov > 0:
        passed = passed + 1

    if sstf_mov <= fcfs_mov:
        passed = passed + 1

    scan_mov: int = disk_scan(reqs, 53, 200)
    if scan_mov > 0:
        passed = passed + 1

    sc: int = seek_count(reqs, 53)
    if sc == 8:
        passed = passed + 1

    avg: int = average_seek(fcfs_mov, sc)
    if avg > 0:
        passed = passed + 1

    return passed
