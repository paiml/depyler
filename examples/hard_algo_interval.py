# Generated by: depyler corpus generator
# Source: hard_algo_interval.py
#
# Interval scheduling and merging intervals.


def merge_intervals(starts: List[int], ends: List[int]) -> List[List[int]]:
    """Merge overlapping intervals. Input as parallel start/end arrays."""
    n: int = len(starts)
    if n == 0:
        return []
    indices: List[int] = []
    i: int = 0
    while i < n:
        indices.append(i)
        i = i + 1
    i = 0
    while i < n - 1:
        j: int = i + 1
        while j < n:
            si: int = indices[i]
            sj: int = indices[j]
            if starts[si] > starts[sj]:
                tmp: int = indices[i]
                indices[i] = indices[j]
                indices[j] = tmp
            elif starts[si] == starts[sj] and ends[si] > ends[sj]:
                tmp2: int = indices[i]
                indices[i] = indices[j]
                indices[j] = tmp2
            j = j + 1
        i = i + 1
    result: List[List[int]] = []
    first_idx: int = indices[0]
    cur_start: int = starts[first_idx]
    cur_end: int = ends[first_idx]
    k: int = 1
    while k < n:
        idx: int = indices[k]
        s: int = starts[idx]
        e: int = ends[idx]
        if s <= cur_end:
            if e > cur_end:
                cur_end = e
        else:
            result.append([cur_start, cur_end])
            cur_start = s
            cur_end = e
        k = k + 1
    result.append([cur_start, cur_end])
    return result


def interval_intersection(s1: List[int], e1: List[int], s2: List[int], e2: List[int]) -> List[List[int]]:
    """Find intersections of two sets of intervals."""
    n1: int = len(s1)
    n2: int = len(s2)
    result: List[List[int]] = []
    i: int = 0
    j: int = 0
    while i < n1 and j < n2:
        lo: int = s1[i]
        if s2[j] > lo:
            lo = s2[j]
        hi: int = e1[i]
        if e2[j] < hi:
            hi = e2[j]
        if lo <= hi:
            result.append([lo, hi])
        if e1[i] < e2[j]:
            i = i + 1
        else:
            j = j + 1
    return result


def max_non_overlapping(starts: List[int], ends: List[int]) -> int:
    """Maximum number of non-overlapping intervals (activity selection)."""
    n: int = len(starts)
    if n == 0:
        return 0
    indices: List[int] = []
    i: int = 0
    while i < n:
        indices.append(i)
        i = i + 1
    i = 0
    while i < n - 1:
        j: int = i + 1
        while j < n:
            si: int = indices[i]
            sj: int = indices[j]
            if ends[si] > ends[sj]:
                tmp: int = indices[i]
                indices[i] = indices[j]
                indices[j] = tmp
            j = j + 1
        i = i + 1
    count: int = 1
    first_idx: int = indices[0]
    last_end: int = ends[first_idx]
    k: int = 1
    while k < n:
        idx: int = indices[k]
        if starts[idx] >= last_end:
            count = count + 1
            last_end = ends[idx]
        k = k + 1
    return count


def insert_interval(starts: List[int], ends: List[int], new_s: int, new_e: int) -> List[List[int]]:
    """Insert a new interval and merge overlapping."""
    all_s: List[int] = []
    all_e: List[int] = []
    i: int = 0
    while i < len(starts):
        all_s.append(starts[i])
        all_e.append(ends[i])
        i = i + 1
    all_s.append(new_s)
    all_e.append(new_e)
    return merge_intervals(all_s, all_e)


def test_module() -> int:
    """Test all interval functions."""
    passed: int = 0

    r1: List[List[int]] = merge_intervals([1, 2, 8, 15], [3, 6, 10, 18])
    if len(r1) == 3:
        passed = passed + 1

    r2: List[List[int]] = merge_intervals([1, 1, 1], [4, 4, 4])
    if len(r2) == 1:
        passed = passed + 1

    r3: List[List[int]] = interval_intersection([0, 8], [4, 15], [2, 10], [6, 12])
    if len(r3) == 2:
        passed = passed + 1

    r4: int = max_non_overlapping([1, 3, 0, 5, 8, 5], [2, 4, 6, 7, 9, 9])
    if r4 == 4:
        passed = passed + 1

    r5: List[List[int]] = insert_interval([1, 6], [3, 9], 2, 5)
    if len(r5) == 2:
        passed = passed + 1

    r6: List[List[int]] = merge_intervals([], [])
    if len(r6) == 0:
        passed = passed + 1

    return passed
