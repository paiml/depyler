# Generated by: depyler corpus generator
# Source: hard_adv_hash_polynomial.py
#
# Polynomial hashing with multiple bases and moduli for collision resistance.


def poly_hash(data: list[int], seed: int, modulus: int) -> int:
    """Compute polynomial hash: sum(data[i] * seed^i) mod modulus."""
    h: int = 0
    pw: int = 1
    i: int = 0
    n: int = len(data)
    while i < n:
        val: int = data[i]
        h = (h + val * pw) % modulus
        pw = (pw * seed) % modulus
        i = i + 1
    return h


def double_hash(data: list[int]) -> tuple[int, int]:
    """Compute two independent polynomial hashes for collision resistance."""
    h1: int = poly_hash(data, 31, 1000000007)
    h2: int = poly_hash(data, 37, 999999937)
    return (h1, h2)


def hash_equal(data_a: list[int], data_b: list[int]) -> int:
    """Check if two sequences have matching double hashes. Returns 1 or 0."""
    ha: tuple[int, int] = double_hash(data_a)
    hb: tuple[int, int] = double_hash(data_b)
    ha0: int = ha[0]
    ha1: int = ha[1]
    hb0: int = hb[0]
    hb1: int = hb[1]
    if ha0 == hb0 and ha1 == hb1:
        return 1
    return 0


def hash_bucket(val: int, num_buckets: int) -> int:
    """Map a value to a bucket using polynomial hash."""
    data: list[int] = []
    b0: int = val % 256
    b1: int = (val // 256) % 256
    b2: int = (val // 65536) % 256
    data.append(b0)
    data.append(b1)
    data.append(b2)
    h: int = poly_hash(data, 31, 1000000007)
    return h % num_buckets


def hash_combine_list(values: list[int]) -> int:
    """Combine a list of values into a single hash."""
    h: int = 0
    i: int = 0
    n: int = len(values)
    while i < n:
        val: int = values[i]
        h = h ^ ((val * 2654435) % 1000000007)
        h = (h * 31 + 17) % 1000000007
        i = i + 1
    return h


def test_module() -> int:
    """Test polynomial hash functions."""
    passed: int = 0

    h1: int = poly_hash([1, 2, 3], 31, 1000000007)
    h2: int = poly_hash([1, 2, 3], 31, 1000000007)
    if h1 == h2:
        passed = passed + 1

    h3: int = poly_hash([3, 2, 1], 31, 1000000007)
    if h3 != h1:
        passed = passed + 1

    eq1: int = hash_equal([1, 2, 3], [1, 2, 3])
    if eq1 == 1:
        passed = passed + 1

    eq2: int = hash_equal([1, 2, 3], [4, 5, 6])
    if eq2 == 0:
        passed = passed + 1

    b1: int = hash_bucket(42, 10)
    if b1 >= 0 and b1 < 10:
        passed = passed + 1

    hc: int = hash_combine_list([10, 20, 30])
    if hc >= 0:
        passed = passed + 1

    return passed
