[package]
name = "depyler-oracle"
version.workspace = true
edition.workspace = true
authors.workspace = true
license.workspace = true
repository.workspace = true
description = "ML-powered compile error classification and auto-fixing using aprender models"
keywords = ["depyler", "ml", "error-classification", "auto-fix"]
categories = ["development-tools"]

[features]
default = ["gpu", "compressed-models"]
gpu = ["aprender/gpu"]  # Enable GPU acceleration for ML training
compressed-models = ["aprender/format-compression"]  # Zstd compression (lossless, 14x smaller)
local-llm = ["llama-cpp-2"]

[dependencies]
# Depyler core for error types
depyler-core = { path = "../depyler-core" }

# ML models from aprender (local dev)
# Features: parallel (rayon), gpu (wgpu via trueno)
aprender = { path = "../../../aprender", default-features = true }

# Data loading and versioning
alimentar = { path = "../../../alimentar" }
arrow = { version = "53", default-features = false, features = ["prettyprint"] }
parquet = { version = "53", default-features = false, features = ["arrow", "snap"] }

# Serialization
serde.workspace = true
serde_json.workspace = true

# Error handling
anyhow.workspace = true
thiserror.workspace = true

# Logging
tracing.workspace = true

# Regex for pattern matching in autofixer
regex.workspace = true

# Home directory detection
dirs = "5"

# HTTP client for API fallback
ureq = { version = "2.9", features = ["json"] }

# Local LLM inference via llama.cpp
llama-cpp-2 = { version = "0.1", optional = true }

[dev-dependencies]
tempfile.workspace = true
proptest.workspace = true
clap = { version = "4", features = ["derive"] }

# Synthetic data factory for corpus generation
verificar = "0.3"
