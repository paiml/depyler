<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080" width="1920" height="1080">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="boxGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#0f3460;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1a1a2e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="successGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1b4332;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#081c15;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="oracleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#7b2cbf;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#3c096c;stop-opacity:1" />
    </linearGradient>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e94560" />
    </marker>
    <marker id="arrowheadGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#52b788" />
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="4" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="1920" height="1080" fill="#0a0a0f"/>

  <!-- Title -->
  <text x="960" y="60" font-family="system-ui, -apple-system, sans-serif" font-size="36" font-weight="bold" fill="#ffffff" text-anchor="middle">DEPYLER ORACLE TRAINING FLOW</text>
  <text x="960" y="95" font-family="system-ui, -apple-system, sans-serif" font-size="18" fill="#888888" text-anchor="middle">depyler train --corpus PATH</text>

  <!-- Phase 1: Input -->
  <g transform="translate(80, 140)">
    <rect x="0" y="0" width="320" height="180" rx="12" fill="url(#boxGrad)" stroke="#e94560" stroke-width="2" filter="url(#shadow)"/>
    <text x="160" y="35" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#e94560" text-anchor="middle">1. USER CORPUS</text>
    <line x1="20" y1="50" x2="300" y2="50" stroke="#333" stroke-width="1"/>
    <text x="160" y="80" font-family="monospace" font-size="14" fill="#aaaaaa" text-anchor="middle">~/myproject/*.py</text>
    <rect x="40" y="100" width="240" height="60" rx="6" fill="#1a1a2e" stroke="#444" stroke-width="1"/>
    <text x="160" y="125" font-family="monospace" font-size="12" fill="#52b788" text-anchor="middle">class MyClass:</text>
    <text x="160" y="145" font-family="monospace" font-size="12" fill="#52b788" text-anchor="middle">    def process(self)...</text>
  </g>

  <!-- Arrow 1 -->
  <line x1="420" y1="230" x2="500" y2="230" stroke="#e94560" stroke-width="3" marker-end="url(#arrowhead)"/>

  <!-- Phase 2: Converge -->
  <g transform="translate(520, 140)">
    <rect x="0" y="0" width="360" height="180" rx="12" fill="url(#boxGrad)" stroke="#e94560" stroke-width="2" filter="url(#shadow)"/>
    <text x="180" y="35" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#e94560" text-anchor="middle">2. CONVERGE LOOP</text>
    <line x1="20" y1="50" x2="340" y2="50" stroke="#333" stroke-width="1"/>
    <text x="180" y="80" font-family="system-ui, sans-serif" font-size="14" fill="#aaaaaa" text-anchor="middle">Transpile + Compile + Fix</text>

    <rect x="30" y="95" width="130" height="70" rx="6" fill="#1a1a2e" stroke="#444" stroke-width="1"/>
    <text x="95" y="120" font-family="system-ui, sans-serif" font-size="12" fill="#888" text-anchor="middle">Python</text>
    <text x="95" y="140" font-family="monospace" font-size="11" fill="#52b788" text-anchor="middle">.py -> .rs</text>

    <text x="180" y="135" font-family="system-ui, sans-serif" font-size="20" fill="#e94560" text-anchor="middle">-></text>

    <rect x="200" y="95" width="130" height="70" rx="6" fill="#1a1a2e" stroke="#444" stroke-width="1"/>
    <text x="265" y="120" font-family="system-ui, sans-serif" font-size="12" fill="#888" text-anchor="middle">rustc</text>
    <text x="265" y="140" font-family="monospace" font-size="11" fill="#e94560" text-anchor="middle">E0308, E0599...</text>
  </g>

  <!-- Arrow 2 -->
  <line x1="900" y1="230" x2="980" y2="230" stroke="#e94560" stroke-width="3" marker-end="url(#arrowhead)"/>

  <!-- Phase 3: Fix Applied -->
  <g transform="translate(1000, 140)">
    <rect x="0" y="0" width="320" height="180" rx="12" fill="url(#boxGrad)" stroke="#52b788" stroke-width="2" filter="url(#shadow)"/>
    <text x="160" y="35" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#52b788" text-anchor="middle">3. FIX APPLIED</text>
    <line x1="20" y1="50" x2="300" y2="50" stroke="#333" stroke-width="1"/>
    <text x="160" y="80" font-family="system-ui, sans-serif" font-size="14" fill="#aaaaaa" text-anchor="middle">Auto-fix resolves error</text>
    <rect x="40" y="95" width="240" height="65" rx="6" fill="#1a1a2e" stroke="#52b788" stroke-width="1"/>
    <text x="160" y="118" font-family="monospace" font-size="11" fill="#888" text-anchor="middle">error_code: "E0308"</text>
    <text x="160" y="138" font-family="monospace" font-size="11" fill="#52b788" text-anchor="middle">fix: "as_str() coercion"</text>
  </g>

  <!-- Arrow 3 -->
  <line x1="1340" y1="230" x2="1420" y2="230" stroke="#52b788" stroke-width="3" marker-end="url(#arrowheadGreen)"/>

  <!-- Phase 4: Record Feedback -->
  <g transform="translate(1440, 140)">
    <rect x="0" y="0" width="400" height="180" rx="12" fill="url(#oracleGrad)" stroke="#c77dff" stroke-width="2" filter="url(#shadow)"/>
    <text x="200" y="35" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#ffffff" text-anchor="middle">4. RECORD FEEDBACK</text>
    <line x1="20" y1="50" x2="380" y2="50" stroke="#5a189a" stroke-width="1"/>
    <text x="200" y="80" font-family="monospace" font-size="13" fill="#e0aaff" text-anchor="middle">user_predictor.learn_pattern()</text>
    <rect x="30" y="95" width="340" height="65" rx="6" fill="#240046" stroke="#7b2cbf" stroke-width="1"/>
    <text x="200" y="118" font-family="monospace" font-size="11" fill="#c77dff" text-anchor="middle">error_message -> fix_template</text>
    <text x="200" y="138" font-family="monospace" font-size="11" fill="#e0aaff" text-anchor="middle">ErrorCategory::from_code("E0308")</text>
  </g>

  <!-- Center flow - Second row -->

  <!-- Arrow down from Phase 4 -->
  <line x1="1640" y1="340" x2="1640" y2="420" stroke="#c77dff" stroke-width="3" marker-end="url(#arrowhead)"/>

  <!-- Phase 5: NgramFixPredictor -->
  <g transform="translate(1240, 440)">
    <rect x="0" y="0" width="400" height="200" rx="12" fill="url(#oracleGrad)" stroke="#c77dff" stroke-width="2" filter="url(#shadow)"/>
    <text x="200" y="35" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#ffffff" text-anchor="middle">5. NGRAM FIX PREDICTOR</text>
    <line x1="20" y1="50" x2="380" y2="50" stroke="#5a189a" stroke-width="1"/>

    <rect x="30" y="65" width="340" height="120" rx="6" fill="#240046" stroke="#7b2cbf" stroke-width="1"/>
    <text x="200" y="90" font-family="monospace" font-size="12" fill="#c77dff" text-anchor="middle">patterns: HashMap&lt;ErrorCategory,</text>
    <text x="200" y="110" font-family="monospace" font-size="12" fill="#c77dff" text-anchor="middle">           Vec&lt;FixPattern&gt;&gt;</text>
    <line x1="50" y1="125" x2="350" y2="125" stroke="#5a189a" stroke-width="1"/>
    <text x="200" y="148" font-family="monospace" font-size="11" fill="#e0aaff" text-anchor="middle">FixPattern { error_pattern,</text>
    <text x="200" y="168" font-family="monospace" font-size="11" fill="#e0aaff" text-anchor="middle">  fix_template, success_rate }</text>
  </g>

  <!-- Arrow from Phase 5 to Phase 6 -->
  <line x1="1240" y1="540" x2="1140" y2="540" stroke="#c77dff" stroke-width="3" marker-end="url(#arrowhead)"/>

  <!-- Phase 6: Save Model -->
  <g transform="translate(720, 440)">
    <rect x="0" y="0" width="400" height="200" rx="12" fill="url(#successGrad)" stroke="#52b788" stroke-width="2" filter="url(#shadow)"/>
    <text x="200" y="35" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#52b788" text-anchor="middle">6. SAVE USER MODEL</text>
    <line x1="20" y1="50" x2="380" y2="50" stroke="#1b4332" stroke-width="1"/>

    <rect x="30" y="65" width="340" height="50" rx="6" fill="#081c15" stroke="#2d6a4f" stroke-width="1"/>
    <text x="200" y="95" font-family="monospace" font-size="13" fill="#52b788" text-anchor="middle">~/.depyler/oracle_user.bin</text>

    <rect x="30" y="130" width="340" height="55" rx="6" fill="#081c15" stroke="#2d6a4f" stroke-width="1"/>
    <text x="200" y="155" font-family="monospace" font-size="12" fill="#40916c" text-anchor="middle">serde_json::to_string_pretty()</text>
    <text x="200" y="175" font-family="monospace" font-size="12" fill="#52b788" text-anchor="middle">Persists between sessions</text>
  </g>

  <!-- Arrow from Phase 6 to Phase 7 -->
  <line x1="720" y1="540" x2="620" y2="540" stroke="#52b788" stroke-width="3" marker-end="url(#arrowheadGreen)"/>

  <!-- Phase 7: Future Runs -->
  <g transform="translate(200, 440)">
    <rect x="0" y="0" width="400" height="200" rx="12" fill="url(#boxGrad)" stroke="#e94560" stroke-width="2" filter="url(#shadow)"/>
    <text x="200" y="35" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#e94560" text-anchor="middle">7. FUTURE CONVERGE RUNS</text>
    <line x1="20" y1="50" x2="380" y2="50" stroke="#333" stroke-width="1"/>

    <text x="200" y="80" font-family="system-ui, sans-serif" font-size="14" fill="#aaaaaa" text-anchor="middle">Loads and applies learned patterns</text>

    <rect x="30" y="95" width="340" height="90" rx="6" fill="#1a1a2e" stroke="#444" stroke-width="1"/>
    <text x="200" y="120" font-family="monospace" font-size="12" fill="#888" text-anchor="middle">user_predictor.load(&amp;user_model_path)</text>
    <line x1="50" y1="135" x2="350" y2="135" stroke="#333" stroke-width="1"/>
    <text x="200" y="158" font-family="system-ui, sans-serif" font-size="13" fill="#52b788" text-anchor="middle">Faster convergence with</text>
    <text x="200" y="178" font-family="system-ui, sans-serif" font-size="13" fill="#52b788" text-anchor="middle">project-specific patterns</text>
  </g>

  <!-- Loop arrow from Phase 7 back to Phase 2 -->
  <path d="M 400 440 Q 400 380 520 340" fill="none" stroke="#e94560" stroke-width="2" stroke-dasharray="8,4" marker-end="url(#arrowhead)"/>

  <!-- Bottom info boxes -->
  <g transform="translate(80, 720)">
    <rect x="0" y="0" width="550" height="280" rx="12" fill="url(#boxGrad)" stroke="#444" stroke-width="1" filter="url(#shadow)"/>
    <text x="275" y="35" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#e94560" text-anchor="middle">CLI USAGE</text>
    <line x1="20" y1="50" x2="530" y2="50" stroke="#333" stroke-width="1"/>

    <text x="40" y="85" font-family="monospace" font-size="14" fill="#52b788"># Train on your project</text>
    <text x="40" y="110" font-family="monospace" font-size="14" fill="#ffffff">depyler train --corpus ~/myproject/</text>

    <text x="40" y="150" font-family="monospace" font-size="14" fill="#52b788"># With custom output path</text>
    <text x="40" y="175" font-family="monospace" font-size="14" fill="#ffffff">depyler train --corpus ./src \</text>
    <text x="40" y="200" font-family="monospace" font-size="14" fill="#ffffff">    --output ./my_model.bin</text>

    <text x="40" y="240" font-family="monospace" font-size="14" fill="#52b788"># Subsequent compiles use patterns</text>
    <text x="40" y="265" font-family="monospace" font-size="14" fill="#ffffff">depyler compile myfile.py</text>
  </g>

  <g transform="translate(680, 720)">
    <rect x="0" y="0" width="550" height="280" rx="12" fill="url(#boxGrad)" stroke="#444" stroke-width="1" filter="url(#shadow)"/>
    <text x="275" y="35" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#c77dff" text-anchor="middle">KEY FILES</text>
    <line x1="20" y1="50" x2="530" y2="50" stroke="#333" stroke-width="1"/>

    <text x="40" y="85" font-family="monospace" font-size="13" fill="#888">depyler-oracle/src/ngram.rs</text>
    <text x="40" y="108" font-family="system-ui, sans-serif" font-size="12" fill="#aaa">  save(), load(), learn_pattern(), record_feedback()</text>

    <text x="40" y="145" font-family="monospace" font-size="13" fill="#888">depyler/src/converge/mod.rs</text>
    <text x="40" y="168" font-family="system-ui, sans-serif" font-size="12" fill="#aaa">  Initialize predictor, wire feedback loop, save at end</text>

    <text x="40" y="205" font-family="monospace" font-size="13" fill="#888">depyler/src/lib.rs + main.rs</text>
    <text x="40" y="228" font-family="system-ui, sans-serif" font-size="12" fill="#aaa">  Train CLI command and handler</text>

    <text x="40" y="265" font-family="monospace" font-size="13" fill="#888">~/.depyler/oracle_user.bin</text>
    <text x="40" y="265" font-family="system-ui, sans-serif" font-size="12" fill="#52b788" dx="280">  Persisted patterns</text>
  </g>

  <g transform="translate(1280, 720)">
    <rect x="0" y="0" width="550" height="280" rx="12" fill="url(#successGrad)" stroke="#52b788" stroke-width="1" filter="url(#shadow)"/>
    <text x="275" y="35" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#52b788" text-anchor="middle">BENEFITS</text>
    <line x1="20" y1="50" x2="530" y2="50" stroke="#1b4332" stroke-width="1"/>

    <text x="40" y="90" font-family="system-ui, sans-serif" font-size="15" fill="#52b788">1. Project-Specific Learning</text>
    <text x="60" y="115" font-family="system-ui, sans-serif" font-size="13" fill="#aaa">Learns idioms unique to your codebase</text>

    <text x="40" y="155" font-family="system-ui, sans-serif" font-size="15" fill="#52b788">2. Incremental Improvement</text>
    <text x="60" y="180" font-family="system-ui, sans-serif" font-size="13" fill="#aaa">Each training run adds to knowledge base</text>

    <text x="40" y="220" font-family="system-ui, sans-serif" font-size="15" fill="#52b788">3. Faster Convergence</text>
    <text x="60" y="245" font-family="system-ui, sans-serif" font-size="13" fill="#aaa">Pre-learned fixes applied immediately</text>

    <text x="40" y="275" font-family="system-ui, sans-serif" font-size="12" fill="#40916c">DEPYLER-ORACLE-TRAIN | Commit: 3cca868e</text>
  </g>

</svg>
